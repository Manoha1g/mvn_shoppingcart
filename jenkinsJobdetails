import jenkins.model.Jenkins

pipeline {
   agent any
   stages {
      stage('checkout') {
         steps {
            checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'github', url: 'https://github.com/Manoha1g/mvn_shoppingcart.git']]])
         }
      }
      stage ('test-stage') {
         steps {
            script {
              // Set how old the jobs to list should be (in days)
              def numDaysBack = 30

              def cutOfDate = System.currentTimeMillis() - 1000L * 60 * 60 * 24 * numDaysBack

              for (job in Jenkins.instance.getAllItems(Job.class)) {
                build = job.getLastSuccessfulBuild()
                if (build != null && build.getTimeInMillis() < cutOfDate) {
                  println job.getFullName()
                }
             }
           }
         }
      }
   }
}
